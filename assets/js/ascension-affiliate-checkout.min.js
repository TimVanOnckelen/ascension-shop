(function(f){let clientsForm="#ascension-clients-form";let formCache=null;function e(k,l,n,m,j){c();f.ajax({url:ascension.root+k,method:n,data:JSON.stringify(l),crossDomain:true,contentType:"application/json",xhrFields:{withCredentials:true},beforeSend:function(o){o.setRequestHeader("X-WP-Nonce",ascension.nonce)},success:function(o){i();m(o)},error:function(o){j(o)}})}function h(k,j){e("ascension/v1/add/order/customer",{data:{customer:k,who_pays:j}},"POST",function(o){f(".woocommerce-billing-fields").find("input, textarea").val("");f("#ascension-who-pays-container").show();f(document.body).trigger("update_checkout");if(o.status==true){var l=f.param(o.customer,true);var n=decodeURIComponent(l);var m=d(n);f(".woocommerce-billing-fields").unserializeForm(n);console.log(n);f("#billing_country").val(m.billing_country).trigger("change")}else{f(".woocommerce-billing-fields").unserializeForm(formCache);f("#billing_country").val(m.billing_country).trigger("change")}},function(l){f(document.body).trigger("update_checkout");alert("Something got wrong, try again")})}function a(){c();let customer_id=f("#ascension-clients").val();let whoPays=f("[name='ascension-who-pays']:checked").val();if(customer_id<0){h(0,0);f(document.body).trigger("update_checkout");return}if(formCache==null){formCache=f("form.checkout").serialize()}h(customer_id,whoPays)}function g(){f("#ascension-clients").on("change",function(){a()});f('[name="ascension-who-pays"]').on("change",function(){a()})}function b(){f('[name="ascension-order-for"]').on("change",function(){let isChecked=f("[name='ascension-order-for']:checked").val();if(isChecked==="client"){f(clientsForm).show()}else{f(clientsForm).hide();f("#ascension-clients").val(1);f("#ascension-who-pays-container").hide();h(0,0);if(formCache){f(".woocommerce-billing-fields").unserializeForm(formCache);f("#billing_country").val(formCache.billing_country).trigger("change")}}})}function c(){f(".woocommerce").prepend('<div class="ascension-loader"></div>')}function i(){f(".ascension-loader").remove()}function d(k){k=k.split("&");var j=[];f.each(k,function(){var l=this.split("=");j[l[0].replace(/\+/g," ")]=decodeURI(l[1].replace(/\+/g," "))});return j}f(document).on("ready",function(){f("#ascension-clients").select2({width:"100%",allowClear:true,placeholder:"*"});h(0,0);b();g()})})(jQuery);