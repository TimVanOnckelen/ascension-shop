(function(b){b(document).on("ready",function(){b("#searchByPartner").select2({width:"100%",allowClear:true,placeholder:"*"});b(".searchByPartner").select2({width:"100%",allowClear:true,placeholder:"*"});b("#ascension-clients").select2({width:"100%",allowClear:true,placeholder:"*"});b("#searchOrderByClient").select2({allowClear:true,placeholder:"*",ajax:{url:getClients.url,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",OrderArea.nonce)},data:function(f){var e={search:f.term};return e},processResults:function(e){return{results:b.map(e.items,function(f){return{text:f.text,id:f.id}})}}}});b(".downloadOverview").on("click",function(){b("#affwp-table").removeClass("affwp-table-responsive");b(".printArea").printThis({importCSS:true,importStyle:true,debug:true})});var d=a("id");var c="";console.log("Client Id:".theClientId);if(d!==false){b("#searchOrderByClient").val(d);c={sSearch:d}}else{c=null}let OrdersTable=b(OrderArea.tableId).DataTable({language:{processing:partnerArea.processingText},autoWidth:false,processing:true,serverSide:true,ordering:false,fixedHeader:true,aoSearchCols:[null,null,null,null,c,null,null],ajax:{url:OrderArea.url,type:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",OrderArea.nonce)},complete:function(){b("[name='_wp_http_referer']").val(OrderArea.referer)}},columns:[{data:"id"},{data:"date"},{data:"client"},{data:"partner"},{data:"status"},{data:"shippingdate"},{data:"trackingcode"},{data:"amount"},{data:"actions"}]});OrdersTable.columns().every(function(e){var f=this;if(e===0){b("#order-id-search").on("keypress",function(g){if(g.which===13){theId=b(this).val();if(f.search()!==this.value){f.search(theId).draw()}}})}if(e===1){b("#orders-to,#orders-from").on("change",function(){var i=b("#orders-from").val();var h=b("#orders-to").val();if(i!==""&&h!==""){var g=i+"..."+h;if(f.search()!==this.value){f.search(g).draw()}}})}if(e===2){b("#searchByStatus").on("change",function(){if(f.search()!==this.value){f.search(this.value).draw()}})}if(e===3){b("#searchByPartner").on("change",function(){console.log("Test");if(f.search()!==this.value){f.search(this.value).draw()}})}if(e===4){b("#searchOrderByClient").on("change",function(){if(f.search()!==this.value){f.search(this.value).draw()}})}if(e===5){b("#showAllSubs").on("change",function(){if(f.search()!==this.value){f.search(this.value).draw()}})}});let theTable=b(partnerArea.tableId).DataTable({autoWidth:false,processing:true,serverSide:true,ordering:false,fixedHeader:true,ajax:{url:partnerArea.url,type:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",partnerArea.nonce)},complete:function(){b("[name='_wp_http_referer']").val(partnerArea.referer)}},columns:[{data:"id",render:function(e){return"#"+e+'<br /><a href="#user-edit-'+e+'" rel="modal:open" class="edit-user">'+partnerArea.editText+"</a>"}},{data:"info"},{data:"status"},{data:"partner"},{data:"discount"}]});theTable.columns().every(function(e){var f=this;if(e===0){b("select#searchByPartner").on("change",function(){if(f.search()!==this.value){f.settings()[0].jqXHR.abort();f.search(this.value).draw()}})}if(e===2){b("select#showAllSubs").on("change",function(){if(f.search()!==this.value){f.settings()[0].jqXHR.abort();f.search(this.value).draw()}})}if(e===1){b("#searchByName").on("keyup change",function(){theId=b(this).val();console.log(theId);if(f.search()!==this.value){f.settings()[0].jqXHR.abort();f.search(theId).draw()}})}if(e===3){b("#searchByStatus").on("keyup change",function(){theId=b(this).val();console.log(theId);if(f.search()!==this.value){f.settings()[0].jqXHR.abort();f.search(theId).draw()}})}});b("body").on("submit",".editUser",function(h){h.preventDefault();var g=b(this);var f=g.attr("action");let id=b(this).attr("data-id");b(this).hide();b(this).parent().html("<div id='userEditLoading'><b>"+partnerArea.savingText+"</b></div>");b.ajax({type:"POST",url:f,data:g.serialize(),success:function(e){b("#userEditLoading").remove();Swal.fire({title:partnerArea.successTextTitle,text:partnerArea.successText,type:"success",confirmButtonText:"Ok"});if(b(partnerArea.tableId).length){var i=theTable.page.info();b.modal.close();theTable.ajax.reload(function(){theTable.page(i.page+1)})}else{location.reload()}}})});b("body").on("submit",".editPartner",function(h){h.preventDefault();var g=b(this);var f=g.attr("action");let id=b(this).attr("data-id");b(this).hide().before("<div id='userEditLoading'><b>"+partnerArea.savingText+"</b></div>");b.ajax({type:"POST",url:f,data:g.serialize(),success:function(e){b("#userEditLoading").remove();Swal.fire({title:partnerArea.successTextTitle,text:partnerArea.successTextPartner,type:"success",confirmButtonText:"Ok"});location.reload()}})});b("body").on("submit",".editDiscount",function(i){i.preventDefault();var h=b(this);var f=h.attr("action");var g=h.children(".customer_rate").val();b(this).hide().before("<div id='userEditLoading'><b>"+partnerArea.savingText+"</b></div>");b.ajax({type:"POST",url:f,data:h.serialize(),success:function(e){b("#userEditLoading").remove();Swal.fire({title:partnerArea.successTextTitle,text:partnerArea.succesTextDiscount,type:"success",confirmButtonText:"Ok"});h.show();h.children(".customer_rate").val(g)}})})});function a(c){var e=window.location.search.substring(1);var f=e.split("&");for(var d=0;d<f.length;d++){var g=f[d].split("=");if(g[0]==c){return g[1]}}return(false)}})(jQuery);