(function(f){function i(b,a){if(!a){return}b.append(a.jquery?a.clone():a)}function h(a,d,b){var c=d.clone(b.formValues);if(b.formValues){j(d,c,"select, textarea")}if(b.removeScripts){c.find("script").remove()}if(b.printContainer){c.appendTo(a)}else{c.each(function(){f(this).children().appendTo(a)})}}function j(d,a,c){var b=d.find(c);a.find(c).each(function(l,e){f(e).val(b.eq(l).val())})}var g;f.fn.printThis=function(m){g=f.extend({},f.fn.printThis.defaults,m);var n=this instanceof jQuery?this:f(this);var d="printThis-"+(new Date()).getTime();if(window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)){var a='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";<\/script></head><body></body>")';var b=document.createElement("iframe");b.name="printIframe";b.id=d;b.className="MSIE";document.body.appendChild(b);b.src=a}else{var e=f("<iframe id='"+d+"' name='printIframe' />");e.appendTo("body")}var c=f("#"+d);if(!g.debug){c.css({position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"})}if(typeof g.beforePrint==="function"){g.beforePrint()}setTimeout(function(){function E(p,o){var q,r;q=p.get(0);q=q.contentWindow||q.contentDocument||q;r=q.document||q.contentDocument||q;r.open();r.write(o);r.close()}if(g.doctypeString){E(c,g.doctypeString)}var F=c.contents(),D=F.find("head"),k=F.find("body"),C=f("base"),A;if(g.base===true&&C.length>0){A=C.attr("href")}else{if(typeof g.base==="string"){A=g.base}else{A=document.location.protocol+"//"+document.location.host}}D.append('<base href="'+A+'">');if(g.importCSS){f("link[rel=stylesheet]").each(function(){var o=f(this).attr("href");if(o){var p=f(this).attr("media")||"all";D.append("<link type='text/css' rel='stylesheet' href='"+o+"' media='"+p+"'>")}})}if(g.importStyle){f("style").each(function(){D.append(this.outerHTML)})}if(g.pageTitle){D.append("<title>"+g.pageTitle+"</title>")}if(g.loadCSS){if(f.isArray(g.loadCSS)){jQuery.each(g.loadCSS,function(o,p){D.append("<link type='text/css' rel='stylesheet' href='"+this+"'>")})}else{D.append("<link type='text/css' rel='stylesheet' href='"+g.loadCSS+"'>")}}var y=f("html")[0];F.find("html").prop("style",y.style.cssText);var B=g.copyTagClasses;if(B){B=B===true?"bh":B;if(B.indexOf("b")!==-1){k.addClass(f("body")[0].className)}if(B.indexOf("h")!==-1){F.find("html").addClass(y.className)}}i(k,g.header);if(g.canvas){var z=0;n.find("canvas").addBack("canvas").each(function(){f(this).attr("data-printthis",z++)})}h(k,n,g);if(g.canvas){k.find("canvas").each(function(){var p=f(this).data("printthis"),o=f('[data-printthis="'+p+'"]');this.getContext("2d").drawImage(o[0],0,0);if(f.isFunction(f.fn.removeAttr)){o.removeAttr("data-printthis")}else{f.each(o,function(r,q){q.removeAttribute("data-printthis")})}})}if(g.removeInline){var l=g.removeInlineSelector||"*";if(f.isFunction(f.removeAttr)){k.find(l).removeAttr("style")}else{k.find(l).attr("style","")}}i(k,g.footer);function x(p,o){var q=p.get(0);q=q.contentWindow||q.contentDocument||q;if(typeof o==="function"){if("matchMedia" in q){q.matchMedia("print").addListener(function(r){if(r.matches){o()}})}else{q.onbeforeprint=o}}}x(c,g.beforePrintEvent);setTimeout(function(){if(c.hasClass("MSIE")){window.frames.printIframe.focus();D.append("<script>  window.print(); <\/script>")}else{if(document.queryCommandSupported("print")){c[0].contentWindow.document.execCommand("print",false,null)}else{c[0].contentWindow.focus();c[0].contentWindow.print()}}if(!g.debug){setTimeout(function(){c.remove()},1000)}if(typeof g.afterPrint==="function"){g.afterPrint()}},g.printDelay)},333)};f.fn.printThis.defaults={debug:false,importCSS:true,importStyle:false,printContainer:true,loadCSS:"",pageTitle:"",removeInline:false,removeInlineSelector:"*",printDelay:333,header:null,footer:null,base:false,formValues:true,canvas:false,doctypeString:"<!DOCTYPE html>",removeScripts:false,copyTagClasses:false,beforePrintEvent:null,beforePrint:null,afterPrint:null}})(jQuery);