(function(b){function d(f,g){if(!g){return}f.append(g.jquery?g.clone():g)}function e(i,f,h){var g=f.clone(h.formValues);if(h.formValues){c(f,g,"select, textarea")}if(h.removeScripts){g.find("script").remove()}if(h.printContainer){g.appendTo(i)}else{g.each(function(){b(this).children().appendTo(i)})}}function c(f,i,g){var h=f.find(g);i.find(g).each(function(j,k){b(k).val(h.eq(j).val())})}var a;b.fn.printThis=function(g){a=b.extend({},b.fn.printThis.defaults,g);var f=this instanceof jQuery?this:b(this);var i="printThis-"+(new Date()).getTime();if(window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)){var l='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";<\/script></head><body></body>")';var k=document.createElement("iframe");k.name="printIframe";k.id=i;k.className="MSIE";document.body.appendChild(k);k.src=l}else{var h=b("<iframe id='"+i+"' name='printIframe' />");h.appendTo("body")}var j=b("#"+i);if(!a.debug){j.css({position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"})}if(typeof a.beforePrint==="function"){a.beforePrint()}setTimeout(function(){function t(A,x){var z,y;z=A.get(0);z=z.contentWindow||z.contentDocument||z;y=z.document||z.contentDocument||z;y.open();y.write(x);y.close()}if(a.doctypeString){t(j,a.doctypeString)}var s=j.contents(),u=s.find("head"),r=s.find("body"),v=b("base"),m;if(a.base===true&&v.length>0){m=v.attr("href")}else{if(typeof a.base==="string"){m=a.base}else{m=document.location.protocol+"//"+document.location.host}}u.append('<base href="'+m+'">');if(a.importCSS){b("link[rel=stylesheet]").each(function(){var x=b(this).attr("href");if(x){var y=b(this).attr("media")||"all";u.append("<link type='text/css' rel='stylesheet' href='"+x+"' media='"+y+"'>")}})}if(a.importStyle){b("style").each(function(){u.append(this.outerHTML)})}if(a.pageTitle){u.append("<title>"+a.pageTitle+"</title>")}if(a.loadCSS){if(b.isArray(a.loadCSS)){jQuery.each(a.loadCSS,function(x,y){u.append("<link type='text/css' rel='stylesheet' href='"+this+"'>")})}else{u.append("<link type='text/css' rel='stylesheet' href='"+a.loadCSS+"'>")}}var o=b("html")[0];s.find("html").prop("style",o.style.cssText);var w=a.copyTagClasses;if(w){w=w===true?"bh":w;if(w.indexOf("b")!==-1){r.addClass(b("body")[0].className)}if(w.indexOf("h")!==-1){s.find("html").addClass(o.className)}}d(r,a.header);if(a.canvas){var n=0;f.find("canvas").addBack("canvas").each(function(){b(this).attr("data-printthis",n++)})}e(r,f,a);if(a.canvas){r.find("canvas").each(function(){var y=b(this).data("printthis"),x=b('[data-printthis="'+y+'"]');this.getContext("2d").drawImage(x[0],0,0);if(b.isFunction(b.fn.removeAttr)){x.removeAttr("data-printthis")}else{b.each(x,function(z,A){A.removeAttribute("data-printthis")})}})}if(a.removeInline){var q=a.removeInlineSelector||"*";if(b.isFunction(b.removeAttr)){r.find(q).removeAttr("style")}else{r.find(q).attr("style","")}}d(r,a.footer);function p(z,x){var y=z.get(0);y=y.contentWindow||y.contentDocument||y;if(typeof x==="function"){if("matchMedia" in y){y.matchMedia("print").addListener(function(A){if(A.matches){x()}})}else{y.onbeforeprint=x}}}p(j,a.beforePrintEvent);setTimeout(function(){if(j.hasClass("MSIE")){window.frames.printIframe.focus();u.append("<script>  window.print(); <\/script>")}else{if(document.queryCommandSupported("print")){j[0].contentWindow.document.execCommand("print",false,null)}else{j[0].contentWindow.focus();j[0].contentWindow.print()}}if(!a.debug){setTimeout(function(){j.remove()},1000)}if(typeof a.afterPrint==="function"){a.afterPrint()}},a.printDelay)},333)};b.fn.printThis.defaults={debug:false,importCSS:true,importStyle:false,printContainer:true,loadCSS:"",pageTitle:"",removeInline:false,removeInlineSelector:"*",printDelay:333,header:null,footer:null,base:false,formValues:true,canvas:false,doctypeString:"<!DOCTYPE html>",removeScripts:false,copyTagClasses:false,beforePrintEvent:null,beforePrint:null,afterPrint:null}})(jQuery);